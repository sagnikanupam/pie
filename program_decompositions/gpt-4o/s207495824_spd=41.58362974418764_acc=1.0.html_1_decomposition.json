{"optimized_code": "/*\n\nCode By RyeCatcher\n\n*/\n\n#include <bits/stdc++.h>\n\n#define ri register int \n\n#define ll long long \n\nusing std::min;\n\nusing std::max;\n\nusing std::lower_bound;\n\nconst int maxn=200005;\n\nconst int inf=0x7fffffff;\n\nint n,nn,a[maxn],b[maxn],c[maxn],mx=-inf,mi=inf;\n\nll sum[maxn<<2];\n\ninline void update(int x,int d){for(;x<=nn;x+=x&(-x))sum[x]+=d;}\n\ninline ll query(int x){ll ans=0;for(;x;x-=x&(-x))ans+=sum[x];return ans;}\n\ninline ll chk(int k){\n\n    ll ans=0;\n\n    b[0]=0;\n\n    for(ri i=1;i<=n;i++){\n\n        b[i]=b[i-1]+((a[i]<=k)?1:-1);\n\n        c[i]=b[i];\n\n        ans+=(b[i]>0);\n\n    }\n\n    std::sort(c+1,c+1+n);\n\n    nn=std::unique(c+1,c+1+n)-(c+1);\n\n    memset(sum,0,sizeof(sum));\n\n    for(ri i=1;i<=n;i++){\n\n        b[i]=lower_bound(c+1,c+1+nn,b[i])-c;\n\n        ans+=query(b[i]-1);\n\n        update(b[i],1);\n\n    }\n\n    return ans;\n\n}\n\nint main(){\n\n    scanf(\"%d\", &n);\n\n    for(ri i=1;i<=n;i++){\n\n        scanf(\"%d\", &a[i]);\n\n        mi=min(mi,a[i]),mx=max(mx,a[i]);\n\n    }\n\n    int L=mi,R=mx,mid,ans;\n\n    ll lim=1ll*n*(n+1)/4+1;//\u6ce8\u610flong long \n\n    while(L<=R){\n\n        mid=(L+R)>>1;\n\n        if(chk(mid)>=lim)ans=mid,R=mid-1;\n\n        else L=mid+1;\n\n    }\n\n    printf(\"%d\\n\",ans);\n\n    return 0;\n\n}\n"}